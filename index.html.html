<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEO Ultimate Analyzer & Scraper</title>
    <style>
        :root { --primary: #6200ee; --success: #2ecc71; --warning: #f1c40f; --danger: #e74c3c; --dark: #2c3e50; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f8f9fa; color: var(--dark); margin: 0; padding: 20px; }
        .container { max-width: 1200px; margin: auto; display: grid; grid-template-columns: 1fr 350px; gap: 20px; }
        header { grid-column: 1 / span 2; text-align: center; padding: 20px; background: white; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); margin-bottom: 10px; }
        
        /* Layout Sections */
        .card { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 20px; }
        .sidebar { position: sticky; top: 20px; height: fit-content; }
        
        /* Inputs */
        label { font-weight: bold; display: block; margin-top: 15px; margin-bottom: 5px; font-size: 14px; }
        input, textarea { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 15px; transition: border 0.3s; }
        input:focus { border-color: var(--primary); outline: none; }
        textarea { height: 350px; line-height: 1.6; }
        
        /* Buttons */
        .btn { padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; transition: 0.3s; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { opacity: 0.9; }
        
        /* Score UI */
        .score-circle { width: 120px; height: 120px; border-radius: 50%; border: 8px solid #eee; display: flex; align-items: center; justify-content: center; font-size: 32px; font-weight: bold; margin: 0 auto 15px; position: relative; }
        
        /* Indicators */
        .check-item { font-size: 13.5px; padding: 8px 0; border-bottom: 1px solid #f0f0f0; display: flex; align-items: center; }
        .check-item::before { margin-right: 10px; font-size: 16px; }
        .pass::before { content: '✅'; }
        .fail::before { content: '❌'; }
        
        /* Suggestion Box */
        #suggestions { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; }
        .keyword-tag { background: #eee; padding: 5px 10px; border-radius: 20px; font-size: 12px; cursor: pointer; transition: 0.2s; }
        .keyword-tag:hover { background: var(--primary); color: white; }
        
        .loading { font-size: 12px; color: #666; font-style: italic; }
    </style>
</head>
<body>

<header>
    <h1>SEO <span style="color:var(--primary)">Intelligence</span> Tool</h1>
    <p>Analisis Konten, Scrape URL, dan Riset Keyword dalam satu dashboard.</p>
</header>

<div class="container">
    <main>
        <div class="card">
            <label>Scrape dari URL</label>
            <div style="display: flex; gap: 10px;">
                <input type="text" id="urlInput" placeholder="https://website.com/artikel-target">
                <button class="btn btn-primary" onclick="scrapeWebsite()" id="btnScrape">Ambil Konten</button>
            </div>
            <p id="scrapeStatus" class="loading"></p>
        </div>

        <div class="card">
            <label>Focus Keyword</label>
            <input type="text" id="focusKeyword" placeholder="Apa kata kunci utamanya?" oninput="handleKeywordInput()">
            <div id="suggestions"></div>

            <label>Judul Artikel</label>
            <input type="text" id="title" placeholder="Judul yang SEO-friendly..." oninput="analyzeSEO()">

            <label>Konten Utama</label>
            <textarea id="content" placeholder="Mulai menulis atau paste konten di sini..." oninput="analyzeSEO()"></textarea>
        </div>
    </main>

    <aside class="sidebar">
        <div class="card" style="text-align: center;">
            <div class="score-circle" id="scoreDisplay">0</div>
            <h3 id="scoreLabel">Needs Work</h3>
            <div style="display: flex; justify-content: space-around; font-size: 12px; color: #666;">
                <div>Words: <b id="stat-words">0</b></div>
                <div>Ease: <b id="stat-read">0</b></div>
            </div>
        </div>

        <div class="card">
            <h4 style="margin-top:0;">SEO Checklist</h4>
            <div id="checklist">
                <p style="font-size:12px; color:#888;">Masukkan Keyword & Konten untuk memulai analisis.</p>
            </div>
        </div>
    </aside>
</div>

<script>
const powerWords = ['terbaik', 'terbaru', 'ampuh', 'rahasia', 'cara', 'tips', 'mudah', 'lengkap', 'gratis', 'diskon', '2024', '2025', '2026'];

// FITUR 1: Google Autocomplete Suggestions
async function handleKeywordInput() {
    const kw = document.getElementById('focusKeyword').value;
    if (kw.length < 3) return;

    try {
        // Menggunakan Proxy untuk memanggil Google Autocomplete API
        const response = await fetch(`https://api.allorigins.win/get?url=${encodeURIComponent('http://suggestqueries.google.com/complete/search?output=firefox&q=' + kw)}`);
        const data = await response.json();
        const suggestions = JSON.parse(data.contents)[1];
        
        const container = document.getElementById('suggestions');
        container.innerHTML = suggestions.slice(0, 5).map(s => `
            <span class="keyword-tag" onclick="useKeyword('${s}')">${s}</span>
        `).join('');
    } catch (e) { console.log("Suggestion error"); }
    
    analyzeSEO();
}

function useKeyword(kw) {
    document.getElementById('focusKeyword').value = kw;
    document.getElementById('suggestions').innerHTML = '';
    analyzeSEO();
}

// FITUR 2: Web Scraper (URL to Content)
async function scrapeWebsite() {
    const url = document.getElementById('urlInput').value;
    const btn = document.getElementById('btnScrape');
    const status = document.getElementById('scrapeStatus');

    if (!url) return alert("Masukkan URL!");

    btn.innerText = "...";
    status.innerText = "Menghubungi server dan mengekstrak data...";

    try {
        const response = await fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(url)}`);
        const data = await response.json();
        const parser = new DOMParser();
        const doc = parser.parseFromString(data.contents, 'text/html');

        const title = doc.querySelector('title')?.innerText || doc.querySelector('h1')?.innerText || "";
        const mainContent = doc.querySelector('article, main, .post-content, .entry-content')?.innerText 
                          || doc.body.innerText.substring(0, 20000);

        document.getElementById('title').value = title.trim();
        document.getElementById('content').value = mainContent.trim().replace(/\s+/g, ' ');
        
        status.innerText = "Data berhasil ditarik!";
        analyzeSEO();
    } catch (e) {
        status.innerText = "Gagal mengambil data. Coba URL lain.";
    } finally {
        btn.innerText = "Ambil Konten";
    }
}

// FITUR UTAMA: SEO Score Logic (Metode Rank Math)
function analyzeSEO() {
    const keyword = document.getElementById('focusKeyword').value.toLowerCase();
    const title = document.getElementById('title').value.toLowerCase();
    const content = document.getElementById('content').value;
    const contentLower = content.toLowerCase();
    
    if (!keyword) return;

    let score = 0;
    let checks = [];

    // 1. Basic SEO (Kwd in Title & Beginning)
    if (title.includes(keyword)) {
        score += 15;
        checks.push({ t: "Keyword ada di judul", p: true });
    } else {
        checks.push({ t: "Keyword tidak ada di judul", p: false });
    }

    if (contentLower.substring(0, 600).includes(keyword)) {
        score += 10;
        checks.push({ t: "Keyword di awal paragraf", p: true });
    } else {
        checks.push({ t: "Keyword tidak ada di awal", p: false });
    }

    // 2. Content Length
    const wordCount = content.trim().split(/\s+/).filter(w => w.length > 0).length;
    if (wordCount >= 600) {
        score += 20;
        checks.push({ t: `Panjang konten ideal (${wordCount} kata)`, p: true });
    } else {
        checks.push({ t: "Konten terlalu pendek (< 600 kata)", p: false });
    }

    // 3. Keyword Density (0.8% - 2.5%)
    const kwCount = (contentLower.match(new RegExp(keyword, 'g')) || []).length;
    const density = wordCount > 0 ? ((kwCount / wordCount) * 100).toFixed(2) : 0;
    if (density >= 0.8 && density <= 2.5) {
        score += 15;
        checks.push({ t: `Kepadatan Keyword ideal (${density}%)`, p: true });
    } else {
        checks.push({ t: `Kepadatan Keyword buruk (${density}%)`, p: false });
    }

    // 4. Power Words & Numbers in Title
    const hasPower = powerWords.some(pw => title.includes(pw));
    const hasNumber = /\d/.test(title);
    if (hasPower && hasNumber) {
        score += 15;
        checks.push({ t: "Judul sangat persuasif (Angka + Power Word)", p: true });
    } else {
        checks.push({ t: "Tambahkan Angka/Power Word di judul", p: false });
    }

    // 5. Link Detection
    const hasLinks = contentLower.includes('href=') || contentLower.includes('http');
    if (hasLinks) {
        score += 10;
        checks.push({ t: "Terdapat Internal/External link", p: true });
    } else {
        checks.push({ t: "Tidak ada link ditemukan", p: false });
    }

    // 6. Readability (Flesch Ease)
    const sentences = content.split(/[.!?]+/).length || 1;
    const syllables = (contentLower.match(/[aeiou]/g) || []).length; 
    const ease = Math.round(206.835 - 1.015 * (wordCount / sentences) - 84.6 * (syllables / wordCount || 1));
    if (ease > 60) {
        score += 15;
        checks.push({ t: "Konten mudah dibaca", p: true });
    } else {
        checks.push({ t: "Bahasa terlalu kompleks", p: false });
    }

    updateUI(Math.min(score, 100), checks, wordCount, ease);
}

function updateUI(score, checks, words, ease) {
    const display = document.getElementById('scoreDisplay');
    const label = document.getElementById('scoreLabel');
    display.innerText = score;
    
    // Color Logic
    let color = "var(--danger)";
    let txt = "Needs Work";
    if (score > 80) { color = "var(--success)"; txt = "Great!"; }
    else if (score > 50) { color = "var(--warning)"; txt = "Good"; }
    
    display.style.borderColor = color;
    display.style.color = color;
    label.innerText = txt;
    label.style.color = color;

    document.getElementById('stat-words').innerText = words;
    document.getElementById('stat-read').innerText = ease;
    
    document.getElementById('checklist').innerHTML = checks.map(c => `
        <div class="check-item ${c.p ? 'pass' : 'fail'}">${c.t}</div>
    `).join('');
}
</script>

</body>
</html>